jQuery(function($){function PrintElem(elem){var mywindow=window.open("","PRINT","height=400,width=600");return mywindow.document.write("<html>"),mywindow.document.write($("head").html()),mywindow.document.write("</html><body >"),mywindow.document.write($(elem).wrap("<p/>").parent().html()),mywindow.document.write("</body></html>"),mywindow.document.close(),mywindow.focus(),mywindow.onload=function(){mywindow.print(),mywindow.close()},!0}var wpbdp_checkout={init:function(){var $form=$("form#wpbdp-checkout-form");if(0!=$form.length){var self=this;this.$form=$form,this.$container=this.$form.find("#wpbdp-checkout-form-fields"),this.payment_key=this.$form.find('input[name="payment"]').val(),this.nonce=this.$form.find('input[name="_wpnonce"]').val(),this.working=!1,this.$form.find('input[name="gateway"]').change(function(){if(!self.working){var gateway=self.$form.find('input[name="gateway"]:checked').val();gateway&&self.load_gateway(gateway)}}),this.$form.find('input[name="gateway"]').trigger("change")}},load_gateway:function(gateway_id){var self=this;self.$container.html(""),self.working=!0;var url=wpbdp_global.ajaxurl;url+=url.indexOf("?")>0?"&":"?",url+="payment="+self.payment_key+"&",url+="gateway="+gateway_id,$.post(url,{action:"wpbdp_ajax",handler:"checkout__load_gateway",_wpnonce:self.nonce},function(res){self.$container.removeClass().addClass("wpbdp-payment-gateway-"+gateway_id+"-form-fields"),self.$container.html(res),self.working=!1,$(window).trigger("wpbdp-payment-gateway-loaded",gateway_id)})}};wpbdp_checkout.init(),$(document).on("click",".wpbdp-payment-receipt-print",function(e){e.preventDefault(),PrintElem($(".wpbdp-payment-receipt"))})});