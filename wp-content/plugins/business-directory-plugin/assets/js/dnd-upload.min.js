var wpbdp=window.wpbdp||{};!function($){wpbdp.dnd={setup:function($area,options){options=$.extend(options,{});var $input=$area.find('input[type="file"]');$area.data("dnd-working",!1),$area.on("dragover",function(e){$(this).hasClass("dragging")||$(this).addClass("dragging")}).on("dragleave",function(e){$(this).hasClass("dragging")&&$(this).removeClass("dragging")}),$input.fileupload({url:$area.attr("data-action")?$area.attr("data-action"):options.url,sequentialUploads:!0,dataType:"json",singleFileUploads:!1,dropZone:$area,formData:function(form){return[{name:"images_count",value:$('#wpbdp-uploaded-images .wpbdp-image input[type="hidden"]').length}]},send:function(e,data){return!$area.data("dnd-working")&&(!("undefined"!=typeof options.validate&&!options.validate.call($area,data))&&($area.removeClass("dragging"),$area.removeClass("error"),$area.data("dnd-working",!0),$area.find(".dnd-area-inside").fadeOut("fast",function(){$area.find(".dnd-area-inside-working span").text(data.files.length),$area.find(".dnd-area-inside-working").fadeIn("fast")}),!0))},done:function(e,data){var res=data.result;$area.data("dnd-working",!1),$area.find(".dnd-area-inside-working").hide(),res.success&&($area.find(".dnd-area-inside").fadeIn("fast"),res.data.is_admin&&($area.removeClass("error"),$area.find(".dnd-area-inside-error").hide())),"undefined"!=typeof options.done&&options.done.call($area,res)}}),"undefined"!=typeof options.init&&options.init.call($area)}}}(jQuery);