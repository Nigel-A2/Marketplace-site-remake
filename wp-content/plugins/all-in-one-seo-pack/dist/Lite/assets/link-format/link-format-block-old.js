!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=40)}([function(e,t){e.exports=window.wp.element},,function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},,,function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=window.lodash},function(e,t,n){var o;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var n={}.hasOwnProperty;function r(){for(var e=[],t=0;t<arguments.length;t++){var o=arguments[t];if(o){var i=typeof o;if("string"===i||"number"===i)e.push(o);else if(Array.isArray(o)&&o.length){var s=r.apply(null,o);s&&e.push(s)}else if("object"===i)for(var a in o)n.call(o,a)&&o[a]&&e.push(a)}}return e.join(" ")}e.exports?(r.default=r,e.exports=r):void 0===(o=function(){return r}.apply(t,[]))||(e.exports=o)}()},,function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}e.exports=function(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var o=n(22);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var o=n(23).default,r=n(2);e.exports=function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return r(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function n(){return e.exports=n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},e.exports.__esModule=!0,e.exports.default=e.exports,n.apply(this,arguments)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},,function(e,t,n){var o=n(21);e.exports=function(e,t){if(null==e)return{};var n,r,i=o(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},,,,,function(e,t){e.exports=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function n(t,o){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,n(t,o)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function n(t){return e.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"link",(function(){return _n}));var o=n(15),r=n.n(o),i=n(16),s=n.n(i),a=n(9),l=n.n(a),u=n(10),c=n.n(u),p=n(2),f=n.n(p),d=n(11),h=n.n(d),g=n(12),v=n.n(g),b=n(5),y=n.n(b),m=n(0),w=n(6),k=n(13),O=n.n(k),S=window.wp,x=S.url,_=x.getProtocol,j=x.isValidProtocol,L=x.getAuthority,E=x.isValidAuthority,R=x.getPath,C=x.isValidPath,P=x.getQueryString,N=x.isValidQueryString,T=x.getFragment,F=x.isValidFragment,W=S.i18n,A=W.__,D=W.sprintf;function I(e){if(!e)return!1;var t=e.trim();if(!t)return!1;if(/^\S+:/.test(t)){var n=_(t);if(!j(n))return!1;if(Object(w.startsWith)(n,"http")&&!/^https?:\/\/[^\/\s]/i.test(t))return!1;var o=L(t);if(!E(o))return!1;var r=R(t);if(r&&!C(r))return!1;var i=P(t);if(i&&!N(i))return!1;var s=T(t);if(s&&!F(s))return!1}return!(Object(w.startsWith)(t,"#")&&!F(t))}function M(e){var t=e.url,n=e.opensInNewWindow,o=e.noFollow,r=e.sponsored,i=e.ugc,s=e.text,a={type:"core/link",attributes:{url:t}},l=[];if(n){var u=D(A("%1$s (opens in a new tab)","all-in-one-seo-pack"),s);a.attributes.target="_blank",a.attributes["aria-label"]=u,l.push("noreferrer noopener")}return o&&l.push("nofollow"),r&&l.push("sponsored"),i&&l.push("ugc"),0<l.length&&(a.attributes.rel=l.join(" ")),a}function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=y()(e);if(t){var r=y()(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return v()(this,n)}}var B=wp.element.Component,U=wp.dom,K=U.getOffsetParent,H=U.getRectangleFromRange;function z(){var e=window.getSelection();if(0===e.rangeCount)return{};var t=H(e.getRangeAt(0)),n=t.top+t.height,o=t.left+t.width/2,r=K(e.anchorNode);if(r){var i=r.getBoundingClientRect();n-=i.top,o-=i.left}return{top:n,left:o}}var $=function(e){h()(n,e);var t=V(n);function n(){var e;return l()(this,n),(e=t.apply(this,arguments)).state={style:z()},e}return c()(n,[{key:"render",value:function(){var e=this.props.children,t=this.state.style;return Object(m.createElement)("div",{className:"editor-format-toolbar__selection-position",style:t},e)}}]),n}(B),q=n(7),Q=n.n(q);function G(e){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function X(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function J(e,t){var n=e["page".concat(t?"Y":"X","Offset")],o="scroll".concat(t?"Top":"Left");if("number"!=typeof n){var r=e.document;"number"!=typeof(n=r.documentElement[o])&&(n=r.body[o])}return n}function Z(e){return J(e)}function ee(e){return J(e,!0)}function te(e){var t=function(e){var t,n,o,r=e.ownerDocument,i=r.body,s=r&&r.documentElement;return n=(t=e.getBoundingClientRect()).left,o=t.top,{left:n-=s.clientLeft||i.clientLeft||0,top:o-=s.clientTop||i.clientTop||0}}(e),n=e.ownerDocument,o=n.defaultView||n.parentWindow;return t.left+=Z(o),t.top+=ee(o),t}var ne,oe=new RegExp("^(".concat(/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,")(?!px)[a-z%]+$"),"i"),re=/^(top|right|bottom|left)$/,ie="left";function se(e,t){for(var n=0;n<e.length;n++)t(e[n])}function ae(e){return"border-box"===ne(e,"boxSizing")}"undefined"!=typeof window&&(ne=window.getComputedStyle?function(e,t,n){var o="",r=e.ownerDocument,i=n||r.defaultView.getComputedStyle(e,null);return i&&(o=i.getPropertyValue(t)||i[t]),o}:function(e,t){var n=e.currentStyle&&e.currentStyle[t];if(oe.test(n)&&!re.test(t)){var o=e.style,r=o[ie],i=e.runtimeStyle[ie];e.runtimeStyle[ie]=e.currentStyle[ie],o[ie]="fontSize"===t?"1em":n||0,n=o.pixelLeft+"px",o[ie]=r,e.runtimeStyle[ie]=i}return""===n?"auto":n});var le=["margin","border","padding"];function ue(e,t,n){var o,r={},i=e.style;for(o in t)t.hasOwnProperty(o)&&(r[o]=i[o],i[o]=t[o]);for(o in n.call(e),t)t.hasOwnProperty(o)&&(i[o]=r[o])}function ce(e,t,n){var o,r,i,s=0;for(r=0;r<t.length;r++)if(o=t[r])for(i=0;i<n.length;i++){var a=void 0;a="border"===o?"".concat(o+n[i],"Width"):o+n[i],s+=parseFloat(ne(e,a))||0}return s}function pe(e){return null!=e&&e==e.window}var fe={};function de(e,t,n){if(pe(e))return"width"===t?fe.viewportWidth(e):fe.viewportHeight(e);if(9===e.nodeType)return"width"===t?fe.docWidth(e):fe.docHeight(e);var o="width"===t?["Left","Right"]:["Top","Bottom"],r="width"===t?e.offsetWidth:e.offsetHeight,i=(ne(e),ae(e)),s=0;(null==r||r<=0)&&(r=void 0,(null==(s=ne(e,t))||Number(s)<0)&&(s=e.style[t]||0),s=parseFloat(s)||0),void 0===n&&(n=i?1:-1);var a=void 0!==r||i,l=r||s;if(-1===n)return a?l-ce(e,["border","padding"],o):s;if(a){var u=2===n?-ce(e,["border"],o):ce(e,["margin"],o);return l+(1===n?0:u)}return s+ce(e,le.slice(n),o)}se(["Width","Height"],(function(e){fe["doc".concat(e)]=function(t){var n=t.document;return Math.max(n.documentElement["scroll".concat(e)],n.body["scroll".concat(e)],fe["viewport".concat(e)](n))},fe["viewport".concat(e)]=function(t){var n="client".concat(e),o=t.document,r=o.body,i=o.documentElement[n];return"CSS1Compat"===o.compatMode&&i||r&&r[n]||i}}));var he={position:"absolute",visibility:"hidden",display:"block"};function ge(e){var t,n=arguments;return 0!==e.offsetWidth?t=de.apply(void 0,n):ue(e,he,(function(){t=de.apply(void 0,n)})),t}function ve(e,t,n){var o=n;if("object"!==G(t))return void 0!==o?("number"==typeof o&&(o+="px"),void(e.style[t]=o)):ne(e,t);for(var r in t)t.hasOwnProperty(r)&&ve(e,r,t[r])}se(["width","height"],(function(e){var t=e.charAt(0).toUpperCase()+e.slice(1);fe["outer".concat(t)]=function(t,n){return t&&ge(t,e,n?0:1)};var n="width"===e?["Left","Right"]:["Top","Bottom"];fe[e]=function(t,o){if(void 0===o)return t&&ge(t,e,-1);if(t){ne(t);return ae(t)&&(o+=ce(t,["padding","border"],n)),ve(t,e,o)}}}));var be=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(n,!0).forEach((function(t){X(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({getWindow:function(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow},offset:function(e,t){if(void 0===t)return te(e);!function(e,t){"static"===ve(e,"position")&&(e.style.position="relative");var n,o,r=te(e),i={};for(o in t)t.hasOwnProperty(o)&&(n=parseFloat(ve(e,o))||0,i[o]=n+t[o]-r[o]);ve(e,i)}(e,t)},isWindow:pe,each:se,css:ve,clone:function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);if(e.overflow)for(var o in e)e.hasOwnProperty(o)&&(t.overflow[o]=e.overflow[o]);return t},scrollLeft:function(e,t){if(pe(e)){if(void 0===t)return Z(e);window.scrollTo(t,ee(e))}else{if(void 0===t)return e.scrollLeft;e.scrollLeft=t}},scrollTop:function(e,t){if(pe(e)){if(void 0===t)return ee(e);window.scrollTo(Z(e),t)}else{if(void 0===t)return e.scrollTop;e.scrollTop=t}},viewportWidth:0,viewportHeight:0},fe);var ye=function(e,t,n){n=n||{},9===t.nodeType&&(t=be.getWindow(t));var o=n.allowHorizontalScroll,r=n.onlyScrollIfNeeded,i=n.alignWithTop,s=n.alignWithLeft,a=n.offsetTop||0,l=n.offsetLeft||0,u=n.offsetBottom||0,c=n.offsetRight||0;o=void 0===o||o;var p,f,d,h,g,v,b,y,m,w,k=be.isWindow(t),O=be.offset(e),S=be.outerHeight(e),x=be.outerWidth(e);k?(b=t,w=be.height(b),m=be.width(b),y={left:be.scrollLeft(b),top:be.scrollTop(b)},g={left:O.left-y.left-l,top:O.top-y.top-a},v={left:O.left+x-(y.left+m)+c,top:O.top+S-(y.top+w)+u},h=y):(p=be.offset(t),f=t.clientHeight,d=t.clientWidth,h={left:t.scrollLeft,top:t.scrollTop},g={left:O.left-(p.left+(parseFloat(be.css(t,"borderLeftWidth"))||0))-l,top:O.top-(p.top+(parseFloat(be.css(t,"borderTopWidth"))||0))-a},v={left:O.left+x-(p.left+d+(parseFloat(be.css(t,"borderRightWidth"))||0))+c,top:O.top+S-(p.top+f+(parseFloat(be.css(t,"borderBottomWidth"))||0))+u}),g.top<0||v.top>0?!0===i?be.scrollTop(t,h.top+g.top):!1===i?be.scrollTop(t,h.top+v.top):g.top<0?be.scrollTop(t,h.top+g.top):be.scrollTop(t,h.top+v.top):r||((i=void 0===i||!!i)?be.scrollTop(t,h.top+g.top):be.scrollTop(t,h.top+v.top)),o&&(g.left<0||v.left>0?!0===s?be.scrollLeft(t,h.left+g.left):!1===s?be.scrollLeft(t,h.left+v.left):g.left<0?be.scrollLeft(t,h.left+g.left):be.scrollLeft(t,h.left+v.left):r||((s=void 0===s||!!s)?be.scrollLeft(t,h.left+g.left):be.scrollLeft(t,h.left+v.left)))};function me(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=y()(e);if(t){var r=y()(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return v()(this,n)}}var we=window.wp,ke=we.i18n,Oe=ke.__,Se=ke.sprintf,xe=ke._n,_e=we.element,je=_e.Component,Le=_e.createRef,Ee=we.htmlEntities.decodeEntities,Re=we.keycodes,Ce=Re.UP,Pe=Re.DOWN,Ne=Re.ENTER,Te=Re.TAB,Fe=we.components,We=Fe.Spinner,Ae=Fe.withSpokenMessages,De=Fe.Popover,Ie=we.compose.withInstanceId,Me=we.apiFetch,Ve=we.url.addQueryArgs,Be=function(e){return e.stopPropagation()},Ue=Ae(Ie(function(e){h()(n,e);var t=me(n);function n(e){var o,r=e.autocompleteRef;return l()(this,n),(o=t.apply(this,arguments)).onChange=o.onChange.bind(f()(o)),o.onKeyDown=o.onKeyDown.bind(f()(o)),o.autocompleteRef=r||Le(),o.inputRef=Le(),o.updateSuggestions=Object(w.throttle)(o.updateSuggestions.bind(f()(o)),200),o.suggestionNodes=[],o.state={posts:[],showSuggestions:!1,selectedSuggestion:null},o}return c()(n,[{key:"componentDidUpdate",value:function(){var e=this,t=this.state,n=t.showSuggestions,o=t.selectedSuggestion;n&&null!==o&&!this.scrollingIntoView&&(this.scrollingIntoView=!0,ye(this.suggestionNodes[o],this.autocompleteRef.current,{onlyScrollIfNeeded:!0}),setTimeout((function(){e.scrollingIntoView=!1}),100))}},{key:"componentWillUnmount",value:function(){delete this.suggestionsRequest}},{key:"bindSuggestionNode",value:function(e){var t=this;return function(n){t.suggestionNodes[e]=n}}},{key:"updateSuggestions",value:function(e){var t=this;if(2>e.length||/^https?:/.test(e))this.setState({showSuggestions:!1,selectedSuggestion:null,loading:!1});else{this.setState({showSuggestions:!0,selectedSuggestion:null,loading:!0});var n=Me({path:Ve("/wp/v2/search",{search:e,per_page:20,type:"post"})});n.then((function(e){t.suggestionsRequest===n&&(t.setState({posts:e,loading:!1}),e.length?t.props.debouncedSpeak(Se(xe("%1$d result found, use up and down arrow keys to navigate.","%1$d results found, use up and down arrow keys to navigate.",e.length),e.length),"assertive"):t.props.debouncedSpeak(Oe("No results.","all-in-one-seo-pack"),"assertive"))})).catch((function(){t.suggestionsRequest===n&&t.setState({loading:!1})})),this.suggestionsRequest=n}}},{key:"onChange",value:function(e){var t=e.target.value;this.props.onChange(t),this.updateSuggestions(t)}},{key:"onKeyDown",value:function(e){var t=this.state,n=t.showSuggestions,o=t.selectedSuggestion,r=t.posts,i=t.loading;if(n&&r.length&&!i){var s=this.state.posts[this.state.selectedSuggestion];switch(e.keyCode){case Ce:e.stopPropagation(),e.preventDefault();var a=o?o-1:r.length-1;this.setState({selectedSuggestion:a});break;case Pe:e.stopPropagation(),e.preventDefault();var l=null===o||o===r.length-1?0:o+1;this.setState({selectedSuggestion:l});break;case Te:null!==this.state.selectedSuggestion&&(this.selectLink(s),this.props.speak(Oe("Link selected.","all-in-one-seo-pack")));break;case Ne:null!==this.state.selectedSuggestion&&(e.stopPropagation(),this.selectLink(s))}}else switch(e.keyCode){case Ce:0!==e.target.selectionStart&&(e.stopPropagation(),e.preventDefault(),e.target.setSelectionRange(0,0));break;case Pe:this.props.value.length!==e.target.selectionStart&&(e.stopPropagation(),e.preventDefault(),e.target.setSelectionRange(this.props.value.length,this.props.value.length))}}},{key:"selectLink",value:function(e){this.props.onChange(e.url,e),this.setState({selectedSuggestion:null,showSuggestions:!1})}},{key:"handleOnClick",value:function(e){this.selectLink(e),this.inputRef.current.focus()}},{key:"render",value:function(){var e=this,t=this.props,n=t.value,o=void 0===n?"":n,r=t.autoFocus,i=void 0===r||r,s=t.instanceId,a=t.className,l=this.state,u=l.showSuggestions,c=l.posts,p=l.selectedSuggestion,f=l.loading;return Object(m.createElement)("div",{className:Q()("editor-url-input block-editor-url-input",a)},Object(m.createElement)("input",{autoFocus:i,type:"text","aria-label":Oe("URL","all-in-one-seo-pack"),required:!0,value:o,onChange:this.onChange,onInput:Be,placeholder:Oe("Paste URL or type to search","all-in-one-seo-pack"),onKeyDown:this.onKeyDown,role:"combobox","aria-expanded":u,"aria-autocomplete":"list","aria-owns":"editor-url-input-suggestions-".concat(s),"aria-activedescendant":null!==p?"editor-url-input-suggestion-".concat(s,"-").concat(p):void 0,ref:this.inputRef}),f&&Object(m.createElement)(We,null),u&&!!c.length&&Object(m.createElement)(De,{position:"bottom",noArrow:!0,focusOnMount:!1},Object(m.createElement)("div",{className:Q()("editor-url-input__suggestions","block-editor-url-input__suggestions","".concat(a,"__suggestions")),id:"editor-url-input-suggestions-".concat(s),ref:this.autocompleteRef,role:"listbox"},c.map((function(t,n){return Object(m.createElement)("button",{key:t.id,role:"option",tabIndex:"-1",id:"editor-url-input-suggestion-".concat(s,"-").concat(n),ref:e.bindSuggestionNode(n),className:Q()("editor-url-input__suggestion block-editor-url-input__suggestion",{"is-selected":n===p}),onClick:function(){return e.handleOnClick(t)},"aria-selected":n===p},Ee(t.title)||Oe("(no title)","all-in-one-seo-pack"))})))))}}]),n}(je))),Ke=["autocompleteRef","className","onChangeInputValue","value"],He=window.wp,ze=He.i18n.__,$e=He.components.IconButton;function qe(e){var t=e.autocompleteRef,n=e.className,o=e.onChangeInputValue,i=e.value,s=r()(e,Ke);return Object(m.createElement)("form",O()({className:Q()("block-editor-url-popover__link-editor",n)},s),Object(m.createElement)(Ue,{value:i,onChange:o,autocompleteRef:t}),Object(m.createElement)($e,{icon:"editor-break",label:ze("Apply","all-in-one-seo-pack"),type:"submit"}))}var Qe=["className","linkClassName","onEditLinkClick","url","urlLabel"],Ge=window.wp,Xe=Ge.i18n.__,Ye=Ge.components,Je=Ye.ExternalLink,Ze=Ye.IconButton,et=Ge.url,tt=et.safeDecodeURI,nt=et.filterURLForDisplay;function ot(e){var t=e.url,n=e.urlLabel,o=e.className,r=Q()(o,"block-editor-url-popover__link-viewer-url");return t?Object(m.createElement)(Je,{className:r,href:t},n||nt(tt(t))):Object(m.createElement)("span",{className:r})}function rt(e){var t=e.className,n=e.linkClassName,o=e.onEditLinkClick,i=e.url,s=e.urlLabel,a=r()(e,Qe);return Object(m.createElement)("div",O()({className:Q()("block-editor-url-popover__link-viewer",t)},a),Object(m.createElement)(ot,{url:i,urlLabel:s,className:n}),o&&Object(m.createElement)(Ze,{icon:"edit",label:Xe("Edit","all-in-one-seo-pack"),onClick:o}))}var it=["isActive","addingLink","value","resetOnMount"];function st(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=y()(e);if(t){var r=y()(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return v()(this,n)}}var at=window.wp,lt=at.i18n.__,ut=at.element,ct=ut.Component,pt=ut.createRef,ft=ut.useMemo,dt=ut.Fragment,ht=at.components,gt=ht.ToggleControl,vt=ht.withSpokenMessages,bt=at.keycodes,yt=bt.LEFT,mt=bt.RIGHT,wt=bt.UP,kt=bt.DOWN,Ot=bt.BACKSPACE,St=bt.ENTER,xt=bt.ESCAPE,_t=at.dom.getRectangleFromRange,jt=at.url.prependHTTP,Lt=at.richText,Et=Lt.create,Rt=Lt.insert,Ct=Lt.isCollapsed,Pt=Lt.applyFormat,Nt=Lt.getTextContent,Tt=Lt.slice,Ft=at.blockEditor.URLPopover,Wt=function(e){return e.stopPropagation()};function At(e,t){return e.addingLink||t.editLink}var Dt=function(e){var t=e.isActive,n=e.addingLink,o=e.value,i=e.resetOnMount,s=r()(e,it),a=ft((function(){var e=window.getSelection(),t=0<e.rangeCount?e.getRangeAt(0):null;if(t){if(n)return _t(t);var o=t.startContainer;for(o=o.nextElementSibling||o;o.nodeType!==window.Node.ELEMENT_NODE;)o=o.parentNode;var r=o.closest("a");return r?r.getBoundingClientRect():void 0}}),[t,n,o.start,o.end]);return a?(i(a),Object(m.createElement)(Ft,O()({anchorRect:a},s))):null},It=vt(function(e){h()(n,e);var t=st(n);function n(){var e;return l()(this,n),(e=t.apply(this,arguments)).editLink=e.editLink.bind(f()(e)),e.submitLink=e.submitLink.bind(f()(e)),e.onKeyDown=e.onKeyDown.bind(f()(e)),e.onChangeInputValue=e.onChangeInputValue.bind(f()(e)),e.setLinkTarget=e.setLinkTarget.bind(f()(e)),e.setNoFollow=e.setNoFollow.bind(f()(e)),e.setSponsored=e.setSponsored.bind(f()(e)),e.setUgc=e.setUgc.bind(f()(e)),e.onFocusOutside=e.onFocusOutside.bind(f()(e)),e.resetState=e.resetState.bind(f()(e)),e.autocompleteRef=pt(),e.resetOnMount=e.resetOnMount.bind(f()(e)),e.state={opensInNewWindow:!1,noFollow:!1,sponsored:!1,ugc:!1,inputValue:"",anchorRect:!1},e}return c()(n,[{key:"onKeyDown",value:function(e){-1<[yt,kt,mt,wt,Ot,St].indexOf(e.keyCode)&&e.stopPropagation(),-1<[xt].indexOf(e.keyCode)&&this.resetState()}},{key:"onChangeInputValue",value:function(e){this.setState({inputValue:e})}},{key:"setLinkTarget",value:function(e){var t=this.props,n=t.activeAttributes.url,o=void 0===n?"":n,r=t.value,i=t.onChange;if(this.setState({opensInNewWindow:e}),!At(this.props,this.state)){var s=Nt(Tt(r));i(Pt(r,M({url:o,opensInNewWindow:e,noFollow:this.state.noFollow,sponsored:this.state.sponsored,ugc:this.state.ugc,text:s})))}}},{key:"setNoFollow",value:function(e){var t=this.props,n=t.activeAttributes.url,o=void 0===n?"":n,r=t.value,i=t.onChange;if(this.setState({noFollow:e}),!At(this.props,this.state)){var s=Nt(Tt(r));i(Pt(r,M({url:o,opensInNewWindow:this.state.opensInNewWindow,noFollow:e,sponsored:this.state.sponsored,ugc:this.state.ugc,text:s})))}}},{key:"setSponsored",value:function(e){var t=this.props,n=t.activeAttributes.url,o=void 0===n?"":n,r=t.value,i=t.onChange;if(this.setState({sponsored:e}),!At(this.props,this.state)){var s=Nt(Tt(r));i(Pt(r,M({url:o,opensInNewWindow:this.state.opensInNewWindow,noFollow:this.state.noFollow,sponsored:e,ugc:this.state.ugc,text:s})))}}},{key:"setUgc",value:function(e){var t=this.props,n=t.activeAttributes.url,o=void 0===n?"":n,r=t.value,i=t.onChange;if(this.setState({ugc:e}),!At(this.props,this.state)){var s=Nt(Tt(r));i(Pt(r,M({url:o,opensInNewWindow:this.state.opensInNewWindow,noFollow:this.state.noFollow,sponsored:this.state.sponsored,ugc:e,text:s})))}}},{key:"editLink",value:function(e){this.setState({editLink:!0}),e.preventDefault()}},{key:"submitLink",value:function(e){var t=this.props,n=t.isActive,o=t.value,r=t.onChange,i=t.speak,s=this.state,a=s.inputValue,l=s.opensInNewWindow,u=s.noFollow,c=s.sponsored,p=s.ugc,f=jt(a),d=M({url:f,opensInNewWindow:l,noFollow:u,sponsored:c,ugc:p,text:Nt(Tt(o))});if(e.preventDefault(),Ct(o)&&!n){var h=Pt(Et({text:f}),d,0,f.length);r(Rt(o,h))}else r(Pt(o,d));this.resetState(),I(f)?i(lt(n?"Link edited.":"Link inserted.","all-in-one-seo-pack"),"assertive"):i(lt("Warning: the link has been inserted but could have errors. Please test it.","all-in-one-seo-pack"),"assertive")}},{key:"onFocusOutside",value:function(){var e=this.autocompleteRef.current;e&&e.contains(event.target)||this.resetState()}},{key:"resetState",value:function(){this.props.stopAddingLink(),this.setState({editLink:!1})}},{key:"resetOnMount",value:function(e){this.state.anchorRect!==e&&this.setState({opensInNewWindow:!1,noFollow:!1,sponsored:!1,ugc:!1,anchorRect:e})}},{key:"render",value:function(){var e=this,t=this.props,n=t.isActive,o=t.activeAttributes.url,r=t.addingLink,i=t.value;if(!n&&!r)return null;var s=this.state,a=s.inputValue,l=s.opensInNewWindow,u=s.noFollow,c=s.sponsored,p=s.ugc,f=At(this.props,this.state);return Object(m.createElement)($,{key:"".concat(i.start).concat(i.end)},Object(m.createElement)(Dt,{resetOnMount:this.resetOnMount,value:i,isActive:n,addingLink:r,onFocusOutside:this.onFocusOutside,onClose:function(){a||e.resetState()},focusOnMount:!!f&&"firstElement",renderSettings:function(){return Object(m.createElement)(dt,null,Object(m.createElement)(gt,{label:lt("Open in New Tab","all-in-one-seo-pack"),checked:l,onChange:e.setLinkTarget}),Object(m.createElement)(gt,{label:lt('Add "nofollow" to link',"all-in-one-seo-pack"),checked:u,onChange:e.setNoFollow}),Object(m.createElement)(gt,{label:lt('Add "sponsored" to link',"all-in-one-seo-pack"),checked:c,onChange:e.setSponsored}),Object(m.createElement)(gt,{label:lt('Add "ugc" to link',"all-in-one-seo-pack"),checked:p,onChange:e.setUgc}))}},f?Object(m.createElement)(qe,{className:"editor-format-toolbar__link-container-content block-editor-format-toolbar__link-container-content",value:a,onChangeInputValue:this.onChangeInputValue,onKeyDown:this.onKeyDown,onKeyPress:Wt,onSubmit:this.submitLink,autocompleteRef:this.autocompleteRef}):Object(m.createElement)(rt,{className:"editor-format-toolbar__link-container-content block-editor-format-toolbar__link-container-content",onKeyPress:Wt,url:o,onEditLinkClick:this.editLink,linkClassName:I(jt(o))?void 0:"has-invalid-link"})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.activeAttributes,o=n.url,r=n.target,i=n.rel,s="_blank"===r,a={};if(!At(e,t)&&(o!==t.inputValue&&(a.inputValue=o),s!==t.opensInNewWindow&&(a.opensInNewWindow=s),"string"==typeof i)){var l=i.split(" ").includes("nofollow"),u=i.split(" ").includes("sponsored"),c=i.split(" ").includes("ugc");l!==t.noFollow&&(a.noFollow=l),u!==t.sponsored&&(a.sponsored=u),c!==t.ugc&&(a.ugc=c)}return a}}]),n}(ct));function Mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Vt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=y()(e);if(t){var r=y()(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return v()(this,n)}}var Bt=window.wp,Ut=Bt.i18n.__,Kt=Bt.element,Ht=Kt.Component,zt=Kt.Fragment,$t=Bt.data,qt=$t.select,Qt=$t.withSelect,Gt=Bt.blockEditor,Xt=Gt.BlockControls,Yt=Gt.RichTextToolbarButton,Jt=Gt.RichTextShortcut,Zt=Bt.richText,en=Zt.getTextContent,tn=Zt.applyFormat,nn=Zt.removeFormat,on=Zt.slice,rn=Bt.url.isURL,sn=Bt.components,an=sn.Toolbar,ln=sn.withSpokenMessages,un=Bt.compose,cn=un.compose,pn=un.ifCondition,fn=Ut("Add Link","all-in-one-seo-pack"),dn=/^(mailto:)?[a-z0-9._%+-]+@[a-z0-9][a-z0-9.-]*\.[a-z]{2,63}$/i,hn=function(e){h()(n,e);var t=Vt(n);function n(){var e;return l()(this,n),(e=t.apply(this,arguments)).isEmail=e.isEmail.bind(f()(e)),e.addLink=e.addLink.bind(f()(e)),e.stopAddingLink=e.stopAddingLink.bind(f()(e)),e.onRemoveFormat=e.onRemoveFormat.bind(f()(e)),e.state={addingLink:!1},e}return c()(n,[{key:"isEmail",value:function(e){return dn.test(e)}},{key:"addLink",value:function(){var e=this.props,t=e.value,n=e.onChange,o=en(on(t));o&&rn(o)?n(tn(t,{type:"core/link",attributes:{url:o}})):o&&this.isEmail(o)?n(tn(t,{type:"core/link",attributes:{url:"mailto:".concat(o)}})):this.setState({addingLink:!0})}},{key:"stopAddingLink",value:function(){this.setState({addingLink:!1})}},{key:"onRemoveFormat",value:function(){var e=this.props,t=e.value,n=e.onChange,o=e.speak,r=t;Object(w.map)(["core/link"],(function(e){r=nn(r,e)})),n(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mt(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r)),o(Ut("Link removed.","all-in-one-seo-pack"),"assertive")}},{key:"render",value:function(){var e=this.props,t=e.activeAttributes,n=e.onChange,o=this.props,r=o.isActive,i=o.value;return Object(m.createElement)(zt,null,Object(m.createElement)(Xt,null,Object(m.createElement)(an,{className:"editorskit-components-toolbar"},Object(m.createElement)(Jt,{type:"primary",character:"k",onUse:this.addLink}),Object(m.createElement)(Jt,{type:"primaryShift",character:"k",onUse:this.onRemoveFormat}),r&&Object(m.createElement)(Yt,{name:"link",icon:"editor-unlink",title:Ut("Unlink","all-in-one-seo-pack"),onClick:this.onRemoveFormat,isActive:r,shortcutType:"primaryShift",shortcutCharacter:"k"}),!r&&Object(m.createElement)(Yt,{name:"link",icon:"admin-links",title:fn,onClick:this.addLink,isActive:r,shortcutType:"primary",shortcutCharacter:"k"}),Object(m.createElement)(It,{addingLink:this.state.addingLink,stopAddingLink:this.stopAddingLink,isActive:r,activeAttributes:t,value:i,onChange:n}))))}}]),n}(Ht),gn=cn(Qt((function(){return{isDisabled:qt("core/edit-post").isFeatureActive("disableEditorsKitLinkFormats")}})),pn((function(e){return!e.isDisabled})),ln)(hn),vn=["name"],bn=wp.i18n.__,yn=wp.richText,mn=yn.registerFormatType,wn=yn.unregisterFormatType,kn=yn.applyFormat,On=yn.isCollapsed,Sn=wp.htmlEntities.decodeEntities,xn=wp.url.isURL,_n={name:"core/link",title:bn("Link","all-in-one-seo-pack"),tagName:"a",className:null,attributes:{url:"href",target:"target",rel:"rel"},__unstablePasteRule:function(e,t){var n=t.html,o=t.plainText;if(On(e))return e;var r=(n||o).replace(/<[^>]+>/g,"").trim();return xn(r)?kn(e,{type:"core/link",attributes:{url:Sn(r)}}):e},edit:gn};[_n].forEach((function(e){var t=e.name,n=r()(e,vn);t&&(wn("core/link"),mn(t,n))}))}]);